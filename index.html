<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["json","curl"]);
        });
      </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="json">json</a>
              <a href="#" data-language-name="curl">curl</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='subscription-notification'>Subscription Notification</h1>
<p>The Subscription notification is used to notify you of events relevant to a subscription. The notification includes the following information:</p>

<ul>
<li>Customer details, including contact data</li>
<li>Subscription details, including subscription, plan, and payment data</li>
</ul>
<h2 id='event-types'>Event Types</h2>
<p>There are three main event types that trigger a Subscription notification:</p>

<table><thead>
<tr>
<th>Event Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Subscription Created</td>
<td>Notifies you when a customer has subscribed to a plan and successfully paid for it. You can use the notification to know when to provide the customer with access to the subscribed-to plan.</td>
</tr>
<tr>
<td>Subscription Updated</td>
<td>Notifies you when an existing subscription has been updated and gives a reason for the update. You can use the notification to stay informed about changes to the subscription.</td>
</tr>
<tr>
<td>Subscription Reminder</td>
<td>Notifies you about upcoming subscription events, such as a manual renewal. You can use the notification to know when an action needs to be taken for the subscription.</td>
</tr>
</tbody></table>
<h2 id='how-it-works'>How it Works</h2>
<p>The following describes the notification process:</p>

<ol>
<li> An event happens, such as a customer signing up and paying for a subscription for one of your plans.</li>
<li> The details of the event are saved in the cleverbridge database.</li>
<li> cleverbridge sends you the notification in JSON format as an HTTP PUT request.</li>
<li> If the call was successful, an HTTP 2XX response code is returned to cleverbridge.</li>
<li> If the call failed, an HTTP 5XX response code is returned to cleverbridge. cleverbridge sends follow-up calls until the call is successful.</li>
</ol>
<h2 id='notification-description'>Notification Description</h2>
<p>The notification contains the following information.</p>
<h3 id='notification'>Notification</h3>
<p>| Data  | Type  |  Description  | Required? |
| &mdash;&mdash;&mdash;&mdash; | &mdash;&mdash;&mdash;&mdash;&mdash; |
|  notification_id     | String  | Unique identifier of the notification.  | Required  |
|  event   | Container  | See Event below. | Required  |
|  customer      | Container  | See Customer below.  | Required  |
|  subscription    | Container  | See Subscription below. | Required  |</p>
<h3 id='event'>Event</h3>
<table><thead>
<tr>
<th>Data</th>
<th>Type</th>
<th>Description</th>
<th>Required?</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>String</td>
<td>Type of event. Possible values are <code class="prettyprint">subscription_created</code>, <code class="prettyprint">subscription_updated</code>, or <code class="prettyprint">subscription_reminder</code>.</td>
<td>Required</td>
</tr>
<tr>
<td>reason</td>
<td>String</td>
<td>Reason for the event. Possible values are <code class="prettyprint">canceled</code>, <code class="prettyprint">manual_renewal_confirmed</code>, <code class="prettyprint">manual_renewal_required</code>, <code class="prettyprint">renewal_type_changed</code>,  <code class="prettyprint">renewed</code>, or <code class="prettyprint">upgraded</code>.</td>
<td>Required</td>
</tr>
</tbody></table>
<h3 id='customer'>Customer</h3>
<table><thead>
<tr>
<th>Data</th>
<th>Type</th>
<th>Description</th>
<th>Required?</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">customer_id</code></td>
<td>String</td>
<td>Unique identifier of the customer.</td>
<td>Required</td>
</tr>
<tr>
<td><code class="prettyprint">client_customer_id</code></td>
<td>String</td>
<td>Your internal identifier of the customer.</td>
<td>Optional</td>
</tr>
<tr>
<td><code class="prettyprint">default_contact</code></td>
<td>Container</td>
<td>See Default Contact below.</td>
<td>Required</td>
</tr>
</tbody></table>
<h4 id='default-contact'>Default Contact</h4>
<p>| Data  | Type | Description | Required? |<br>
| &mdash;&mdash;&mdash;- | &mdash;- |&mdash;&mdash;&mdash;&mdash; |
| <code class="prettyprint">locale</code>  | String | Two letter ISO 639-1 code for the customer language. Format: <code class="prettyprint">iso6391</code>  | Required
| <code class="prettyprint">title</code>  | String | Title of the customer.  | Optional
| <code class="prettyprint">first_name</code>  | String |  First name of the customer. | Optional
| <code class="prettyprint">last_name</code>  | String | Last name of the customer.  | Required
| <code class="prettyprint">gender</code>  | String | Gender of the customer. Possible values are <code class="prettyprint">female</code> or <code class="prettyprint">male</code>.  | Optional
| <code class="prettyprint">company</code>  | String | Company of the customer.  | Optional
| <code class="prettyprint">street</code>  | String |  Street address of the customer. | Optional
| <code class="prettyprint">zip_code</code>  | String | Zip code of the customer.  | Optional
| <code class="prettyprint">city</code>  | String | City of the customer.  | Optional
| <code class="prettyprint">state_iso_code</code>  | String | ISO 3166-2 code for the state of the customer. Format: <code class="prettyprint">iso31662</code>  | Optional
| <code class="prettyprint">country_iso_code</code>  | String | ISO 3166-2 code for the country of the customer. Format: <code class="prettyprint">iso31662</code>   | Required
| <code class="prettyprint">phone</code>  | String | Phone number of the customer.  | Optional
| <code class="prettyprint">mobile</code>  | String | Mobile number of the customer.  | Optional
| <code class="prettyprint">fax</code>  | String | Fax number of the customer.  | Optional
| <code class="prettyprint">email</code>  | String | Email address of the customer.  | Required
| <code class="prettyprint">vat_id</code>  | String | VAT ID of the customer.  | Optional</p>
<h3 id='subscription'>Subscription</h3>
<p>| Data  | Type | Description | Required? |<br>
| &mdash;&mdash;&mdash;- | &mdash;- |&mdash;&mdash;&mdash;&mdash; |
| <code class="prettyprint">subscription_id</code>  | String | Unique identifier of the subscription.  | Required
| <code class="prettyprint">client_subscription_id</code>  | String | Your internal identifier of the subscription. | Optional
| <code class="prettyprint">renewal_type</code>  | String | If <code class="prettyprint">auto</code>, subscription renews automatically. If <code class="prettyprint">manual</code>, the customer must initiate the renewal. If <code class="prettyprint">cancel</code>, the subscription will not continue after the renewal date.  | Required
| <code class="prettyprint">status</code>  | String | Status of the subscription. Possible values are: <code class="prettyprint">active</code>, <code class="prettyprint">canceled</code>, <code class="prettyprint">expired</code>, <code class="prettyprint">suspended</code>, or <code class="prettyprint">deleted</code>.  | Required
| <code class="prettyprint">started_at</code>  | Date-Time |  ISO 8601 code for the date and time the subscription became effective. Format: <code class="prettyprint">iso8601</code> | Required
| <code class="prettyprint">next_billing_at</code>  | Date-Time |  ISO 8601 code for the date and time of the next billing event. Format: <code class="prettyprint">iso8601</code> | Optional
| <code class="prettyprint">next_renewal_at</code>  | Date-Time |  ISO 8601 code for the date and time of the next renewal of the subscription contract. Format: <code class="prettyprint">iso8601</code> | Optional
| <code class="prettyprint">canceled_at</code>  | Date-Time |  ISO 8601 code for the date and time the subscription was canceled. Format: <code class="prettyprint">iso8601</code> | Optional
| <code class="prettyprint">ended_at</code>  | Date-Time |  ISO 8601 code for the date and time the subscription ended, if the subscription was set up as a term subscription. Format: <code class="prettyprint">iso8601</code> | Optional
| <code class="prettyprint">currency_iso_code</code>  | String | Alpha 2 ISO 4217 code for the currency of the subscription. Format: <code class="prettyprint">iso4217</code> | Required
| <code class="prettyprint">plans</code>  | Container | Includes one or more plans. See Plan below.  | Required
| <code class="prettyprint">payments</code>  | Container | Includes one or more payment logs. See Payment below. | Required</p>
<h4 id='plan'>Plan</h4>
<p>| Data  | Type | Description | Required? |
| &mdash;&mdash;&mdash;- | &mdash;- |&mdash;&mdash;&mdash;&mdash; |
| <code class="prettyprint">plan_id</code>  | String | Unique identifier of the plan.  | Required
| <code class="prettyprint">client_plan_id</code>  | String | Your internal identifier of the plan.  | Optional
| <code class="prettyprint">plan_version</code>  | Integer | Version number of the plan.  | Required
| <code class="prettyprint">name</code>  | String | Name of the plan.  | Optional
| <code class="prettyprint">billing_cycle_frequency</code>  | String | Period of time between recurring billing events, such as daily, monthly, quarterly, or annually. Example: <code class="prettyprint">3m4d</code>.  | Optional
| <code class="prettyprint">charges</code>  | Container | Includes one or more charges. See Charge below.  | Optional
| <code class="prettyprint">quantity</code>  | String | Number of times this plan is in the subscription.  | Required
| <code class="prettyprint">coupon_code</code>  | String | Identifier of a coupon associated with a promotional discount offer. | Optional
| <code class="prettyprint">custom_data</code>  | String | A set of key/value pairs that you can use for storing additional information about the subscription in a structured format.  | Optional</p>
<h5 id='charge'>Charge</h5>
<p>| Data  | Type | Description | Required? |
| &mdash;&mdash;&mdash;- | &mdash;- |&mdash;&mdash;&mdash;&mdash; |
| <code class="prettyprint">name</code>  | String | Name of the charge.  | Optional
| <code class="prettyprint">price</code>  | Number | Price of the charge.  | Optional</p>
<h4 id='payment'>Payment</h4>
<p>| Data  | Type | Description | Required? |
| &mdash;&mdash;&mdash;- | &mdash;- |&mdash;&mdash;&mdash;&mdash; |
| <code class="prettyprint">created_at</code>  | Date-Time |  ISO 8601 code for the date and time when payment was received. Format: <code class="prettyprint">iso8601</code> | Required
| <code class="prettyprint">payment_provider_transaction_id</code>  | String | Unique identifier of the payment transaction from the payment provider.  | Optional
| <code class="prettyprint">payment_method</code>  | String | How the customer paid, such as by wire transfer, PayPal, MasterCard, etc. | Required
| <code class="prettyprint">card_last_four_digits</code>  | String | Last four digits of the credit card. | Optional
| <code class="prettyprint">card_expiration_date</code>  | String | Expiration date of the credit card. | Optional
| <code class="prettyprint">currency_iso_code</code>  | String | Alpha 2 ISO 4217 code for the currency of the payment. Format: <code class="prettyprint">iso4217</code>  | Required
| <code class="prettyprint">net</code>  | Number | Net amount of the payment.  | Required
| <code class="prettyprint">tax</code>  | Number | Amount of any applicable taxes.  | Required
| <code class="prettyprint">gross</code>  | Number | Gross amount of the payment.  | Required</p>
<pre><code class="highlight json"><span class="w">
     </span><span class="p">{</span><span class="w">
        </span><span class="s2">"notification_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1251A1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"event"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"subscription_created"</span><span class="p">,</span><span class="w">
        </span><span class="err">}</span><span class="p">,</span><span class="w">
         </span><span class="s2">"customer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="s2">"customer_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1251A1"</span><span class="p">,</span><span class="w">
             </span><span class="s2">"client_customer_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABC123"</span><span class="p">,</span><span class="w">
             </span><span class="s2">"default_contact"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                 </span><span class="s2">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"de-DE"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Max"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Samplemann"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Anystreet 123"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"zip_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Anycity"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"country_iso_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DE"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example@examplecompany.com"</span><span class="w">
            </span><span class="p">}</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="s2">"subscription"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="s2">"subscription_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1251A1"</span><span class="p">,</span><span class="w">
             </span><span class="s2">"renewal_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manual"</span><span class="p">,</span><span class="w">
             </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
             </span><span class="s2">"started_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-09-02T14:44:43.314789Z"</span><span class="p">,</span><span class="w">
             </span><span class="s2">"next_billing_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-09-02T14:44:43.610217Z"</span><span class="p">,</span><span class="w">
             </span><span class="s2">"next_renewal_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-09-02T14:44:43.610217Z"</span><span class="p">,</span><span class="w">
             </span><span class="s2">"currency_iso_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EUR"</span><span class="p">,</span><span class="w">
             </span><span class="s2">"plans"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                 </span><span class="p">{</span><span class="w">
                     </span><span class="s2">"plan_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1251A1"</span><span class="p">,</span><span class="w">
                     </span><span class="s2">"plan_version"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                     </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Keepster Professional"</span><span class="p">,</span><span class="w">
                     </span><span class="s2">"billing_cycle_frequency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1y"</span><span class="p">,</span><span class="w">
                     </span><span class="s2">"charges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                         </span><span class="p">{</span><span class="w">
                             </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Yearly"</span><span class="p">,</span><span class="w">
                             </span><span class="s2">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">199</span><span class="w">
                         </span><span class="p">}</span><span class="w">
                     </span><span class="p">],</span><span class="w">
                     </span><span class="s2">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
                     </span><span class="s2">"custom_data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                         </span><span class="s2">"license_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456ABC"</span><span class="w">
                     </span><span class="p">}</span><span class="w">
                 </span><span class="p">}</span><span class="w">
             </span><span class="p">],</span><span class="w">
         </span><span class="s2">"payment_log"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
             </span><span class="p">{</span><span class="w">
                 </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-09-02T14:44:43.314789Z"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"payment_provider_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"payment_method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mastercard"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"card_last_four_digits"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"card_expiration_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1/2016"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"currency_iso_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EUR"</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"net"</span><span class="p">:</span><span class="w"> </span><span class="mf">167.23</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"tax"</span><span class="p">:</span><span class="w"> </span><span class="mf">31.77</span><span class="p">,</span><span class="w">
                 </span><span class="s2">"gross"</span><span class="p">:</span><span class="w"> </span><span class="mi">199</span><span class="w">
             </span><span class="p">}</span><span class="w">
         </span><span class="p">]</span><span class="w">
     </span><span class="p">}</span><span class="w">

</span></code></pre>
<h1 id='upgrade-a-subscription'>Upgrade a Subscription</h1>
<p>A subscription upgrade happens when a customer chooses to replace an existing plan with a better plan. The access to the new plan is available to the customer immediately. The rebilling for the new plan, however, takes place at the next billing event.</p>
<h2 id='request'>Request</h2>
<p>PUT https://api-subscription.cleverbridge.com/v1/subscriptions/{subscription_id}</p>

<p>The following parameters are required:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">action</code></td>
<td>String</td>
<td>The <code class="prettyprint">upgrade</code> value replaces the initial plan with the new plan.</td>
</tr>
<tr>
<td><code class="prettyprint">plan_id</code></td>
<td>String</td>
<td>Unique identifier of the plan.</td>
</tr>
</tbody></table>
<pre><code class="highlight plaintext">     curl PUT https://api-subscription.cleverbridge.com/v1/subscriptions/1251A1 \
      -H "Authorization: Bearer [token]" \
      -H "Accept: application/json" \
      -d '{ "action": "upgrade" }'
      -d '{ "plan_id": "1251A1" }'
</code></pre>

<blockquote>
<p>Response: If the upgrade was successful, a 200 response is returned. A Subscription notification is sent with an event type of <code class="prettyprint">subscription_updated</code> and the reason for the update as <code class="prettyprint">upgraded</code>. </p>
</blockquote>

          <h1 id='errors'>Errors</h1>
<p><aside class="notice">This error section is stored in a separate file in <code class="prettyprint">includes/_errors.md</code>. Slate allows you to optionally separate out your docs into many files&hellip;just save them to the <code class="prettyprint">includes</code> folder and add them to the top of your <code class="prettyprint">index.md</code>&rsquo;s frontmatter. Files are included in the order listed.</aside></p>

<p>The Kittn API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request sucks</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is wrong</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; The kitten requested is hidden for administrators only</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified kitten could not be found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access a kitten with an invalid method</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that isn&rsquo;t json</td>
</tr>
<tr>
<td>410</td>
<td>Gone &ndash; The kitten requested has been removed from our servers</td>
</tr>
<tr>
<td>418</td>
<td>I&rsquo;m a teapot</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests &ndash; You&rsquo;re requesting too many kittens! Slown down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="json">json</a>
                <a href="#" data-language-name="curl">curl</a>
          </div>
      </div>
    </div>
  </body>
</html>
